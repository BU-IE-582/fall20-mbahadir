to_list(for(i in a) i)
to_vector(for(i in a) i)
to_vec(for(i in a) i)
df_Bet365$categ=to_vec(for(i in a) if ((df_Bet365$home_prob-df_Bet365$home_prob)>i && (df_Bet365$home_prob-df_Bet365$home_prob)<i) (i+1)/0.2)
df_Bet365
df_Bet365$categ=to_vec(for(i in a) if ((df_Bet365$home_prob-df_Bet365$home_prob)>i && (df_Bet365$home_prob-df_Bet365$home_prob)<i) (i+1)/0.2)
df_Bet365$categ=
to_vec(for(i in a) if ((df_Bet365$home_prob-df_Bet365$home_prob)>i && (df_Bet365$home_prob-df_Bet365$home_prob)<i) (i+1)/0.2)
df_Bet365$categ=
b<-to_vec(for(i in a) if ((df_Bet365$home_prob-df_Bet365$home_prob)>i && (df_Bet365$home_prob-df_Bet365$home_prob)<i) (i+1)/0.2)
df_Bet365$categ=
b<-to_vec(for(i in a) if((df_Bet365$home_prob-df_Bet365$home_prob)>i && (df_Bet365$home_prob-df_Bet365$home_prob)<i) (i+1)/0.2)
to_vec(for(i in a) if(i%%2==0) i)
to_vec(for(i in a) if(i%%0.2==0) i)
df_Bet365$categ=
b<-to_vec(for(i in a) if(i>(df_Bet365$home_prob-df_Bet365$home_prob) && i<(df_Bet365$home_prob-df_Bet365$home_prob+0.2)) (i+1)/0.2)
to_vec(for(i in a) if(i%%0.2==0 && i!= 0) i)
df_Bet365$categ=
b<-to_vec(for(i in a) if(i>(df_Bet365$home_prob-df_Bet365$home_prob) && i<(df_Bet365$home_prob-df_Bet365$home_prob+0.2)) i)
df_Bet365$home_prob-df_Bet365$home_prob
df_Bet365$categ=
b<-to_vec(for(i in a) if(i>(df_Bet365$home_prob-df_Bet365$away_prob) && i<(df_Bet365$home_prob-df_Bet365$away_prob+0.2)) i)
print(1:78)
df_Bet365$categ=
b<-to_vec(for(in in 1:78) for(i in a)
if(i>(df_Bet365$home_prob[in]-df_Bet365$away_prob[in]) &&
i<(df_Bet365$home_prob[in]-df_Bet365$away_prob[in]+0.2)) i)
df_Bet365$categ=
b<-to_vec(for(posi in 1:78) for(i in a)
if(i>(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]) &&
i<(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]+0.2)) i)
df_Bet365$categ=
b<-to_vec(for(posi in 1:78) for(i in a)
if(i>(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]) &&
i<(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]+0.2)) (i+1)/0.2)
df_Bet365$home_prob-df_Bet365$away_prob
b
df_Bet365$home_prob-df_Bet365$away_prob
df_Bet365$categ=to_vec(for(posi in 1:78) for(i in a)
if(i>(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]) &&
i<(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]+0.2)) (i+1)/0.2)
View(df_Bet365)
x <- runif(1000, 0, 100)
z <- cut2(x, c(10,20,30))
table(z)
install.packages("cut2")
ggplot(df_Bet365,aes(x=home_prob-away_prob,y=categ))+ geom_bar(stat='identity')+xlim(-1,1)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity')
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity')+xlim(0,10)
min(home_prob-away_prob)
min(df_Bet365$home_prob-df_Bet365$away_prob)
max(df_Bet365$home_prob-df_Bet365$away_prob)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(0,10)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)+
scale_x_discrete(labels = a)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)+
scale_x_continuous(breaks = a)
b<-seq(-1,1,by=0.2)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)+
scale_x_continuous(breaks = b)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)+
scale_x_continuous(breaks = seq(-1,1), by = 0.2))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+xlim(-1,1)+
scale_x_continuous(breaks = seq(-1,1, by = 0.2))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_continuous(breaks = seq(-1,1, by = 0.2))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(name ="Dose", seq(-1,1,0.2))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(seq(-1,1,0.2))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(c(-11,0.5,1))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=c(-1,0.5,1))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x=category)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="category",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=mean(draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Bins",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw Prob",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=mean(draw_prob)))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw Prob",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw Prob",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw Prob",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw Prob",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_continious(limits=seq(-1,1,0.2))+labs(x="Draw Prob",y="Draw Prob")
discrete
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_continuous(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")
df_Bet365
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(df_Bet365, aes(x=(categ-5)/5, y=FTR==D))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(df_Bet365, aes(x=(categ-5)/5, y=FTR==D))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(df_Bet365, aes(x=(categ-5)/5, y=(FTR=="D")))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(df_Bet365, aes(x=(categ-5)/5, y=(FTR=="D")))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(aes(x=(df_Bet365$categ-5)/5, y=(df_Bet365[df_Bet365[FTR=="D"]])))
df_Bet365[FTR=="D"]
df_Bet365[FTR]
df_Bet365["FTR"]
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(aes(x=(df_Bet365$categ-5)/5, y=(df_Bet365[df_Bet365["FTR"=="D"]])))
df_Bet365["FTR"]
df_Bet365["FTR"]=="D"
as.numeric(df_Bet365["FTR"]=="D")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(aes(x=(df_Bet365$categ-5)/5, y=as.numeric(df_Bet365["FTR"]=="D")))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(aes(x=(categ-5)/5, y=as.numeric(df_Bet365["FTR"]=="D")))
df_Bet365$draw=as.numeric(df_Bet365["FTR"]=="D")
df_Bet365
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(aes(x=(categ-5)/5, y=draw))
table(df_Bet365$categ,df_Bet365$draw)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_boxplot(aes(x=(categ-5)/5, y=draw))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw))
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(aes(x=(categ-5)/5, y=draw),stat="identity")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_histogram(aes(x=(categ-5)/5, y=draw),stat="identity")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_line(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_line(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(aes(x=(categ-5)/5, y=draw),stat="identity")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_line(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity")
?geom_bar
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_line(stat='identity')+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity",fill="red")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity',fill="green")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity",fill="red")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity',fill="green",alpha=0.5=)+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity",fill="red")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity',fill="green",alpha=0.5)+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity",fill="red")
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity',fill="black",alpha=1)+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=(categ-5)/5,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=(categ-5)/5, y=draw),stat="identity",fill="yellow",alpha=.3)
count(df_Bet365$categ)
summary(df_Bet365$categ)
str(df_Bet365$categ)
table(df_Bet365$categ)
df_Bet365$categ=to_vec(for(posi in 1:78) for(i in a)
if(i>(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]) &&
i<(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]+0.2)) i)
max(df_Bet365$home_prob-df_Bet365$away_prob)
ggplot(df_Bet365,aes(x=categ/5,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
df_Bet365[df_Bet365$categ]
ggplot(df_Bet365,aes(x=categ,y=draw_prob/(df_Bet365[df_Bet365$categ==x])))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob/(df_Bet365[df_Bet365$categ=="x"])))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob)))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
table(df_Bet365$categ,df_Bet365$draw)
table(df_Bet365$categ)
df_Bet365$draw/df_Bet365$categ
table(df_Bet365$categ)
table(df_Bet365$categ)[1]
table(df_Bet365$categ)[2]
len(table(df_Bet365$categ))
len(table(df_Bet365$categ))
table(df_Bet365$categ)
(max(df_Bet365$categ)-min(df_Bet365$categ))*5
(max(df_Bet365$categ)-min(df_Bet365$categ))*5+1
df_Bet365$total_categ=to_vec(for(posi in 1:78) for(i in (max(df_Bet365$categ)-min(df_Bet365$categ))*5+1)
if(df_Bet365$categ[posi]==i) table(df_Bet365$categ,df_Bet365$draw)[i])
df_Bet365
a<-to_vec(for(posi in 1:78) for(i in (max(df_Bet365$categ)-min(df_Bet365$categ))*5+1)
if(df_Bet365$categ[posi]==i) table(df_Bet365$categ,df_Bet365$draw)[i])
df_Bet365$categ[1]
df_Bet365[df_Bet365$categ]
table(df_Bet365$categ)
table(df_Bet365$categ)[0]
table(df_Bet365$categ)[1]
seq(-1,1,by=0.2)
a<-to_vec(for(posi in 1:78) for(i in seq(min(df_Bet365$categ),max(df_Bet365$categ), by=0.2))
if(df_Bet365$categ[posi]==i) table(df_Bet365$categ)[i])
df_Bet365$total_categto_vec(for(posi in 1:78) for(i in seq(min(df_Bet365$categ),max(df_Bet365$categ), by=0.2))
if(df_Bet365$categ[posi]==i) table(df_Bet365$categ)[i])
df_Bet365$total_cat=to_vec(for(posi in 1:78) for(i in seq(min(df_Bet365$categ),max(df_Bet365$categ), by=0.2))
if(df_Bet365$categ[posi]==i) table(df_Bet365$categ)[i])
a
df_Bet365$categ
df_Bet365$total_cat=to_vec(for(posi in 1:78) for(i in seq(min(df_Bet365$categ),max(df_Bet365$categ), by=0.2))
if(df_Bet365$categ[posi]==i) table(df_Bet365$categ)[(i-min(df_Bet365$categ))*5+1])
a<-to_vec(for(posi in 1:78) for(i in seq(min(df_Bet365$categ),max(df_Bet365$categ), by=0.2))
if(df_Bet365$categ[posi]==i) table(df_Bet365$categ)[(i-min(df_Bet365$categ))*5+1])
a
seq(min(df_Bet365$categ),max(df_Bet365$categ), by=0.2)
min_int=min(df_Bet365$categ)
max_int=max(df_Bet365$categ)
seq(min_int,max_int, by=0.2)
seq(int(min_int),max_int, by=0.2)
seq(as.integer(min_int),max_int, by=0.2)
seq(as.float(min_int),max_int, by=0.2)
seq(min_int,max_int, by=0.2)
seq(-0.6,0.8, by=0.2)
#################3
a<-seq(-1,0.8,by=0.2)
a
b<-seq(-0.6,0.8,0.2)
b<-seq(-0.600,0.8,0.2)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(df_Bet365$categ[posi]==i) as.integer(table(df_Bet365$categ)[(i-min(df_Bet365$categ))*5+1]))
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(df_Bet365$categ[posi]==i) as.integer(table(df_Bet365$categ)[(i-min_int)*5+1]))
a
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(i==df_Bet365$categ[posi]) as.integer(table(df_Bet365$categ)[(i-min_int)*5+1]))
seq(min_int,max_int, by=0.2)
df_Bet365$categ
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(i==df_Bet365$categ[posi]) as.integer(table(df_Bet365$categ)[(0)*5+1]))
table(df_Bet365$categ)[(0)*5+1]
as.integer(table(df_Bet365$categ)[(0)*5+1])
5
as.integer(table(df_Bet365$categ)[(0)*5+1])
View(df_Bet365)
table(df_Bet365$categ)
a
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(i==df_Bet365$categ[posi]) as.integer(table(df_Bet365$categ)[(i)*5+1]))
a
table(df_Bet365$categ)[1]
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(i==df_Bet365$categ[posi]) as.integer(table(df_Bet365$categ)[(i+0.6)*5+1]))
table(df_Bet365$categ)[8]
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(i==df_Bet365$categ[posi]) (i+0.6)*5+1)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(i==df_Bet365$categ[posi]) i)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(i==as.numeric(df_Bet365$categ[posi])) i)
seq(min_int,max_int, by=0.2)
1:78
#################3
a<-seq(-1,1,by=0.2)
df_Bet365$categ=to_vec(for(posi in 1:78) for(i in a)
if(i>(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]) &&
i<(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]+0.2)) i)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(as.numeric(df_Bet365$categ[posi])==i) i)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
table(df_Bet365$categ)[8]
a<-to_vec(for(i in seq(min_int,max_int, by=0.2)) for(posi in 1:78)
if(as.numeric(df_Bet365$categ[posi])==i) i)
a<-to_vec(for(i in seq(min_int,max_int, by=0.2)) for(posi in 1:78)
if(as.numeric(df_Bet365$categ[posi])==i) i)
as.numeric(df_Bet365$categ[1])
as.numeric(df_Bet365$categ[2])
as.numeric(df_Bet365$categ[3])
as.numeric(df_Bet365$categ[4])
seq(min_int,max_int, by=0.2)
seq(min_int,max_int, by=0.2)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(as.numeric(df_Bet365$categ[2])==i) i)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(as.numeric(df_Bet365$categ[posi])==i) i)
table(df_Bet365$categ)
df_Bet365$categ=to_vec(for(posi in 1:78) for(i in a)
if(i>(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]) &&
i<(df_Bet365$home_prob[posi]-df_Bet365$away_prob[posi]+0.2)) i)
a<-to_vec(for(posi in 1:78) for(i in seq(min_int,max_int, by=0.2))
if(as.numeric(df_Bet365$categ[posi])==i) i)
a
table(df_Bet365$categ)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw/table(df_Bet365$categ)),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=drawx),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
a<-t=to_vec(for(posi in 1:78) for(i in a)
if(i==as.numeric(df_Bet365$categ[posi])) i)
a<-to_vec(for(posi in 1:78) for(i in a)
if(i==as.numeric(df_Bet365$categ[posi])) i)
as.numeric(df_Bet365$categ[4])
as.numeric(df_Bet365$categ[3])
a<-to_vec(for(posi in 1:3) for(i in a)
if(i==as.numeric(df_Bet365$categ[posi])) i)
a
a<-t=to_vec(for(posi in 1:3) for(i in a)
if(i>=(as.numeric(df_Bet365$categ[posi])) &&
i<=(as.numeric(df_Bet365$categ[posi]))) i)
a<-to_vec(for(posi in 1:3) for(i in a)
if(i>=(as.numeric(df_Bet365$categ[posi])) &&
i<=(as.numeric(df_Bet365$categ[posi]))) i)
a<-to_vec(for(posi in 1:3) for(i in a)
if(i>=(as.numeric(df_Bet365$categ[posi])) &&
i<=(as.numeric(df_Bet365$categ[posi]))) i)
a<-to_vec(for(posi in 1:3) for(j in a)
if(i>=(as.numeric(df_Bet365$categ[posi])) &&
i<=(as.numeric(df_Bet365$categ[posi]))) i)
a<-to_vec(for(posi in 1:3) for(i in a)
if(i>=(as.numeric(df_Bet365$categ[posi])) &&
i<=(as.numeric(df_Bet365$categ[posi]))) i)
a<-to_vec(for(posi in 1:3) for(k in a)
if(i>=(as.numeric(df_Bet365$categ[posi])) &&
i<=(as.numeric(df_Bet365$categ[posi]))) i)
posi
a<-to_vec(for(posi in 1:3) for(k in a)
if(k>=(as.numeric(df_Bet365$categ[posi])) &&
k<=(as.numeric(df_Bet365$categ[posi]))) i)
a<-to_vec(for(posi in 1:3) for(k in a)
if(k>=(as.numeric(df_Bet365$categ[posi])) &&
k<=(as.numeric(df_Bet365$categ[posi]))) k)
d<-to_vec(for(posi in 1:3) for(k in a)
if(k>=(as.numeric(df_Bet365$categ[posi])) &&
k<=(as.numeric(df_Bet365$categ[posi]))) k)
table(df_Bet365$categ)
table(df_Bet365$categ==-0.6)
table(df_Bet365$categ,df_Bet365$draw)
table(df_Bet365$categ,df_Bet365$draw==1)
table(df_Bet365$categ,df_Bet365$draw==1)
table(df_Bet365$categ,df_Bet365$draw=="1")
?tapply
library(data.table)
df_Bet365$tot_cat=0
View(df_Bet365)
df_Bet365$tot_cat_per=0
drop(df_Bet365$tot_cat)
df_Bet365 = subset(mydata, select = -tot_cat )
df_Bet365 = subset(df_Bet365, select = -tot_cat )
tapply(df_Bet365$draw, df_Bet365$categ, mean)
df<-tapply(df_Bet365$draw, df_Bet365$categ, mean)
df
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(df,stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(df,stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_line(df)#stat="identity",fill="yellow",alpha=.3
df_Bet365[,tot_cat_per:=tapply(draw,categ,mean)]
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(df_Bet365,aes(x=categ,y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(df_Bet365,aes(x=categ,y=draw),stat="identity",fill="yellow",alpha=.3)
ggplot(df_Bet365,aes(x=categ,y=draw_prob))+ geom_bar(stat='identity',fill="black")+
scale_x_discrete(limits=seq(-1,1,0.2))+labs(x="Draw",y="Draw Prob")+
geom_bar(aes(x=categ, y=draw),stat="identity",fill="yellow",alpha=.3)
df_Bet365[,"tot_cat_per":=tapply(draw,categ,mean)]
df_Bet365[,tot_cat_per:=tapply(draw,categ,mean)]
df_Bet365[,tot_cat_per:=tapply(draw,categ,mean)]
df_Bet365[,tot_cat_per1:=tapply(draw,categ,mean)]
tapply(draw,categ,mean)
tapply(df_Bet365$draw,df_Bet365$dcateg,mean)
tapply(df_Bet365$draw,df_Bet365$categ,mean)
tapply(df_Bet365$draw,df_Bet365$categ,mean)
df_Bet365[,tot_cat_per1:=tapply(df_Bet365$draw,df_Bet365$categ,mean)]
df_Bet365[,"tot_cat_per"=NULL]
df_Bet365[,tot_cat_per=NULL]
df_Bet365[,tot_cat_per:=NULL]
df_Bet365[,"tot_cat_per":=NULL]
View(df_Bet365)
df_Bet365[,tot_cat_per:=NULL]
library(data.table)
df_Bet365[,tot_cat_per:=NULL]
summary(df_Bet365)
str(df_Bet365)
df_all=fread("E0.csv")
str(df_all)
df=df_all[,1:56]
str(df)
summary(df)
library(ggplot2)
#TASK 1
###Part 1
hist(df$FTHG, ylab="Number of Games", xlab="Home Goals",main="Histogram of Home Goals")
hist(df$FTAG, ylab="Number of Games", xlab="Away Goals",main="Histogram of Away Goals")
hist(df$FTHG-df$FTAG, ylab="Number of Games", xlab="HHome goals – Away Goals",
main="Histogram of Difference")
###Part 2
hist1<-hist(df$FTHG, ylab="Number of Games", xlab="Home Goals",main="Histogram of Home Goals")
x <- df$FTHG
xfit<-seq(min(x),max(x),length=78)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(hist1$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)
yfite<-dexp(xfit,rate=1/mean(x),log = FALSE)
yfite <- yfite*diff(hist1$mids[1:2])*length(x)
lines(xfit, yfite, col="blue", lwd=2)
hist2<-hist(df$FTAG, ylab="Number of Games", xlab="Away Goals",main="Histogram of Away Goals")
x1 <- df$FTAG
xfit1<-seq(min(x1),max(x1),length=78)
yfit1<-dnorm(xfit1,mean=mean(x1),sd=sd(x1))
yfit1 <- yfit1*diff(hist2$mids[1:2])*length(x1)
lines(xfit1, yfit1, col="blue", lwd=2)
hist3<-hist(df$FTHG-df$FTAG, ylab="Number of Games", xlab="HHome goals – Away Goals",
main="Histogram of Difference")
x2 <- df$FTHG-df$FTAG
xfit2<-seq(min(x2),max(x2),length=78)
yfit2<-dnorm(xfit2,mean=mean(x2),sd=sd(x2))
yfit2 <- yfit2*diff(hist2$mids[1:2])*length(x2)
lines(xfit2, yfit2, col="blue", lwd=2)
df_Bet365=df[,c(8,25,26,27)]
df_BetAndWin=df[,c(8,28,29,30)]
df_Pinnacle=df[,c(8,34,35,36)]
df_IW=df[,c(8,31,32,33)]
###PART 1
df_Bet365$home_prob=1/df_Bet365$B365H
df_Bet365$draw_prob=1/df_Bet365$B365D
df_Bet365$away_prob=1/df_Bet365$B365A
df_BetAndWin$home_prob=1/df_BetAndWin$BWH
df_BetAndWin$draw_prob=1/df_BetAndWin$BWD
df_BetAndWin$away_prob=1/df_BetAndWin$BWA
df_Pinnacle$home_prob=1/df_Pinnacle$PSH
df_Pinnacle$draw_prob=1/df_Pinnacle$PSD
df_Pinnacle$away_prob=1/df_Pinnacle$PSA
df_IW$home_prob=1/df_IW$IWH
df_IW$draw_prob=1/df_IW$IWD
df_IW$away_prob=1/df_IW$IWA
###PART 2
df_Bet365$total_prob=df_Bet365$home_prob+df_Bet365$draw_prob+df_Bet365$away_prob
df_Bet365$normalized_home_prob=(1/df_Bet365$B365H)/df_Bet365$total_prob
df_Bet365$normalized_draw_prob=(1/df_Bet365$B365D)/df_Bet365$total_prob
df_Bet365$normalized_away_prob=(1/df_Bet365$B365A)/df_Bet365$total_prob
df_BetAndWin$total_prob=df_BetAndWin$home_prob+df_BetAndWin$draw_prob+df_BetAndWin$away_prob
df_BetAndWin$normalized_home_prob=(1/df_BetAndWin$BWH)/df_BetAndWin$total_prob
df_BetAndWin$normalized_draw_prob=(1/df_BetAndWin$BWD)/df_BetAndWin$total_prob
df_BetAndWin$normalized_away_prob=(1/df_BetAndWin$BWA)/df_BetAndWin$total_prob
df_Pinnacle$total_prob=df_Pinnacle$home_prob+df_Pinnacle$draw_prob+df_Pinnacle$away_prob
df_Pinnacle$normalized_home_prob=(1/df_Pinnacle$PSH)/df_Pinnacle$total_prob
df_Pinnacle$normalized_draw_prob=(1/df_Pinnacle$PSD)/df_Pinnacle$total_prob
df_Pinnacle$normalized_away_prob=(1/df_Pinnacle$PSA)/df_Pinnacle$total_prob
df_IW$total_prob=df_IW$home_prob+df_IW$draw_prob+df_IW$away_prob
df_IW$normalized_home_prob=(1/df_IW$IWH)/df_IW$total_prob
df_IW$normalized_draw_prob=(1/df_IW$IWD)/df_IW$total_prob
df_IW$normalized_away_prob=(1/df_IW$IWA)/df_IW$total_prob
str(df_Bet365)
ggplot(df_BetAndWin,aes(x=home_prob-away_prob,y=draw_prob))+ geom_bar(stat='identity', width  = 0.2)+xlim(-1,1)
ggplot(df_Pinnacle,aes(x=home_prob-away_prob,y=draw_prob))+ geom_bar(stat='identity', width  = 0.2)+xlim(-1,1)
ggplot(df_IW,aes(x=home_prob-away_prob,y=draw_prob))+ geom_bar(stat='identity', width  = 0.2)+xlim(-1,1)
#################3
a<-seq(-1,1,by=0.2)
df_Bet365$draw=as.numeric(df_Bet365["FTR"]=="D")
install.packages("comprehenr")
install.packages("comprehenr")
library(comprehenr)
min_int=min(df_Bet365$categ)
max_int=max(df_Bet365$categ)
View(df_Bet365)
df_Bet365$draw=as.numeric(df_Bet365["FTR"]=="D")
df_Bet365[,draw:=FTR="D"]
